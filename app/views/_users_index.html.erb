<h1>ユーザー一覧</h1>

<div class="mb-3"></div>
<table class="table table-hover">
  <thead class="thead-default">
    <tr>
      <th></th>
      <th><%= User.human_attribute_name(:name) %></th>
      <th><%= User.human_attribute_name(:email) %></th>
      <% if current_user.admin? %>
        <th><%= User.human_attribute_name(:admin) %></th>
      <% end %>
      <th><%= User.human_attribute_name(:created_at) %></th>
      <th><%= User.human_attribute_name(:updated_at) %></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td><%= image_tag user.image.variant(resize:'80x80') if user.image.attached? %></td>
        <td><%= link_to_if !current_user.admin?, user.name, user_path(user) %></td>
        <td><%= user.email %></td>
        <% if current_user.admin? %>
          <td><%= user.admin ? "あり" : "なし" %></td>
        <% end %>
        <td><%= user.created_at %></td>
        <td><%= user.updated_at %></td>
        <td>
          <% if current_user.admin? %>
            <%= link_to "削除", admin_user_path(user), method: :delete, data: { confirm: "「#{user.name}を削除します。よろしいですか？」" }, class: "btn btn-danger" %>
          <% elsif current_user.id == user.id %>
            <%= link_to "編集", edit_user_path(user), class: "btn btn-primary" %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>